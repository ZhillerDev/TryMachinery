### 简介

> 笔记记录自油管课程：https://www.youtube.com/watch?v=9J4YWvHMWf4&list=PLw0SimokefZ3uWQoRsyf-gKNSs4Td-0k6&index=4

<br>

### GPIO

`GPIO 2` 口位于 esp32 上，是一个蓝色的 LED，我们可以通过 machine 库简单的对其进行点亮与熄灭的操作

```py
import machine
import time

# 获取GPIO口
led = machine.Pin(2,machine.Pin.OUT)

# 将灯光闪烁封装为一个函数
def blink_gpio_times(nums):
    count = 0
    while(count<nums):
        led.on() # 点亮
        time.sleep(0.5) # 延迟0.5s
        led.off() # 熄灭
        time.sleep(0.5)
        count+=1
    print("light blink complete")
```

<br>

`GPIO 0` 口用于检测 boot 按钮是否按下

该口在上电后默认具有高电平，即 3.3v  
当按住 boot 按钮后，变为低电平，即 0v

```py
import machine

sw = machine.Pin(0,machine.Pin.IN)

# 未按住boot时
print(sw.value()) # 1

# 按住boot时
print(sw.value()) # 0
```

> 小技巧：可以通过检测 GPIO 0 口状态，动态控制 GPIO 2 口，实现点击按钮开关灯

<br>

### 外部中断

```py
import machine
import time

led = machine.Pin(2,machine.Pin.OUT)
sw = machine.Pin(0,machine.Pin.IN)

# 中断回调函数
# 对GPIO 2控制亮灭
def handle_interrupt():
    led.value(not led.value())

# 监听GPIO 0口电平变化，触发器trigger为IRQ
# handler即为触发中断后欲执行的回调函数
sw.irq(trigger=machine.Pin.IRQ_FALLING,handler=handle_interrupt)
```

<br>

### PWM

#### 简要参数介绍

PWM 相关代码与参数简要理解

```py
import machine
import time

en1 = machine.Pin(18,machine.Pin.OUT)
pwm = machine.PWM(en1)

pwm.init() # 初始化PWM

print(pwm)  # 打印PWM相关信息
```

此时我们会得到一个关于当前 PWM 的详细介绍  
`PWM(Pin(18), freq=5000, duty=512, resolution=13, (duty=50.00%, resolution=0.012%), mode=0, channel=0, timer=0)`

`PWM(Pin(18)` 欲激活 PWM 的端口号  
`freq` 切换频率，范围 10hz-40mhz，可视为一个周期  
`duty` 占空比，范围 0-1023（比如设置为 512，即 50%，此时灯泡一半亮）

> 占空比：即高电平占单个周期的长度之比，若占空比最高（1023）则表示全程高电平，若占空比最低（0）则表示全程低电平

<br>

#### 呼吸灯实现

PWM 实现简单呼吸灯

```py
# 注意这里的导入方式，是使用from
from machine import Pin, PWM
import time

# 指定欲使用PWM的输出端口，设置频率为1000hz
led2 = PWM(Pin(2))
led2.freq(1000)


while True:
    # 亮度从第最低到最高
    for i in range(0, 1024):
        led2.duty(i)
        time.sleep_ms(1)

    # 亮度从最高到最低
    for i in range(1023, -1, -1):
        led2.duty(i)
        time.sleep_ms(1)
```

<br>

#### 初始化与卸载

我们可以单独对一个 PWM 进行初始化操作

```py
from machine import Pin,PWM

fq=500
dt=100

pwm = PWM(Pin(2))
pwm.init(freq=fq,duty=dt)

print(pwm)

def stop():
    pwm.deinit()
```

<br>

### 舵机控制

#### PWM 参数换算规则
